#!/bin/bash

if [ "$(ps -e | grep weston)" != "" ]; then
    exit
fi

#Run root daemon
if [ "$(ps -aux | grep waydroid | grep container)" = "" ]; then
    pkexec waydroid-big-start
fi

sleep 1

# wait
if [ "$(ps -aux | grep waydroid | grep container)" = "" ]; then
    sleep 1
fi

# wait
if [ "$(ps -aux | grep waydroid | grep container)" = "" ]; then
    sleep 1
fi

# wait
if [ "$(ps -aux | grep waydroid | grep container)" = "" ]; then
    sleep 1
fi

waydroid show-full-ui &

#Xorg
if [ "$(ps -e | grep Xorg)" != "" ]; then
    echo '[core]
idle-time=0

[shell]
panel-location=""
panel-position=none
locking=false
background-image=/usr/share/waydroid-extra/loading-android.jpg
background-type=scale-crop' > ~/.config/weston.ini

weston --width=6000 --height=6000
waydroid session stop
fi
